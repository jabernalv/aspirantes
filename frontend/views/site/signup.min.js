var urlfassignup="$urlfassignup",abreviaturasidentificacion=$abreviaturasidentificacion,urlsms="$urlsms",_form=$("#form-signup"),_signupbtn=$("#signup-button"),celular="",correo_electronico="",identificacion="",correo_electronicovalido="",celularvalido="",identificacionvalida="",todovalidado=!1,celularvalidado=!1,correo_electronicovalidado=!1,identificacionvalidada=!1;function setMessage(e,i){camarahabilitada?""==e?$("#message-signup").html(""):$("#message-signup").html("<div class='alert-"+i+" alert alert-dismissible' role='alert'>"+e+"</div>"):$("#message-signup").html(messagecamara)}function validacion(){celularvalidado=null!=$("#signupform-celular").val().match(/^[3]\d{9}$/g),correo_electronicovalidado=null!=$("#signupform-correo_electronico").val().match(/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/i)&&$("#signupform-correo_electronico").val()===$("#signupform-repite_correo_electronico").val(),identificacionvalidada=null!=$("#signupform-identificacion").val().match(/^((\d{8})|(\d{10})|(\d{11}))$/g),$("#signupform-celular").val()==celularvalido&&$("#signupform-identificacion").val()==identificacionvalida&&$("#signupform-correo_electronico").val()==correo_electronicovalido?(celular=$("#signupform-celular").val(),identificacion=$("#signupform-identificacion").val(),correo_electronico=$("#signupform-correo_electronico").val(),tokenobtenido=!0,listocelular()):((todovalidado=celularvalidado&&correo_electronicovalidado&&identificacionvalidada)&&setMessage("Dé clic en el botón [TOKEN] para recibir el token en su celular.","info"),$("#obtener-token-button").prop("disabled",!todovalidado),$("#foto-button").prop("disabled",!todovalidado),$("#signupform-token").prop("readonly",!0),$("#signupform-token").val(""),$("#signupform-token").attr("placeholder","Dé clic en el botón [TOKEN] para recibir el token en su celular."),tokenobtenido=!1,_signupbtn.prop("disabled",!0),$("#captcha_wrapper").addClass("disabled-element"))}function listocelular(){celularvalido=celular,correo_electronicovalido=correo_electronico,identificacionvalida=identificacion,$("#signupform-token").prop("readonly",!1),$("#captcha_wrapper").removeClass("disabled-element"),$("#signupform-token").attr("placeholder","Dé clic en el botón [TOKEN] para recibir el token en su celular."),$("#signupform-token").focus()}$("#ayudasignup").load(urlfassignup),$("#documentoidentificacion-button").on("click",function(e){return $("#signupform-documentoidentificacion").click(),!1}),$("#documentoidentificacion-button").on("focusout",function(e){_form.yiiActiveForm("validateAttribute","signupform-documentoidentificacion")}),$("#signupform-documentoidentificacion").on("change",function(e){var i=$("#canvaspdf").get(0),o=$(this).get(0).files[0],n=new FileReader,t=window["pdfjs-dist/build/pdf"],a=i.getContext("2d"),r=URL.createObjectURL(o);a.clearRect(0,0,canvas.width,canvas.height),i.height=0,i.width=0,$("#signupform-pdf_correcto").val(0),"application/pdf"==o.type?(n.onload=function(){t.GlobalWorkerOptions.workerSrc="//mozilla.github.io/pdf.js/build/pdf.worker.js";var e=new Uint8Array(this.result);t.getDocument(e).promise.then(function(e){e.getPage(e.numPages).then(function(e){var o=e.getViewport({scale:1,rotate:0});i.height=o.height,i.width=o.width,e.render({canvasContext:a,viewport:o}),$("#signupform-pdf_correcto").val(1),$("#viewerpdfconfirm").attr("src",r),$("#errorpdf").html("")})},function(e){console.error(e),$("#errorpdf").html("<div class='alert-danger alert alert-dismissible' role='alert'>Debe cargar un pdf legible.</div>"),$("#viewerpdfconfirm").attr("src",""),setMessage("El pdf que intenta cargar no tiene el formato correcto, está dañado o tiene contraseña. Debe usar otro archivo.","danger")})},n.readAsArrayBuffer(o),_form.yiiActiveForm("validateAttribute","signupform-pdf_correcto")):console.error(o.name," no es un archivo pdf.")}),$("#reset-button").on("click",function(){krajeeDialog.confirm("¿Seguro que desea borrar el formulario?",function(e){e&&_form.trigger("reset")})}),_signupbtn.on("click",function(){krajeeDialog.confirm($("#confirm-div").html(),function(e){e&&_form.submit()})}),$(()=>{enableSubmit=function(){setMessage("Dé clic en [REGISTRO] para enviar el formulario.","info"),_signupbtn.prop("disabled",!tokenobtenido),_signupbtn.focus()},disableSubmit=function(){_signupbtn.prop("disabled",!0)}}),setMessage("Ingrese el nombre completo tal como aparece en el documento de identificación.","info"),$(".g-recaptcha").each(function(){this.addEventListener("load",function(e){var i=e.currentTarget.getAttribute("data-tabindex");i&&(e.target.tabIndex=i)},!0)}),$("#signupform-tipo_identificacion_id").parent().find(".select2").on("focusout",function(e){var i=$("#"+$(this).data("spanid"));setMessage("",""),i.html(abreviaturasidentificacion[$("#signupform-tipo_identificacion_id").val()]),_form.yiiActiveForm("validateAttribute","signupform-foto"),_form.yiiActiveForm("validateAttribute","signupform-tipo_identificacion_id"),setMessage("","")}),$("#signupform-tipo_identificacion_id").parent().find(".select2").prop("id","signupform-tipo_identificacion_select2"),$("#signupform-tipo_identificacion_select2").attr("data-message","Seleccione el tipo de identificación."),$("#signupform-tipo_identificacion_select2").attr("data-spanid","span_tipodocumentoidentificacion"),_signupbtn.prop("disabled",!0),$(".nocopypaste").on("paste",function(e){e.preventDefault()}),$(".nocopypaste").on("copy",function(e){e.preventDefault()}),$(".nocopypaste").on("cut",function(e){e.preventDefault()}),$(".nocopypaste").on("select",function(){this.selectionStart=this.selectionEnd}),$(".triminput").on("focusout",function(e){setMessage("",""),$(this).val($.trim($(this).val()))}),$("#signupform-nombres,#signupform-apellidos,#signupform-correo_electronico,#signupform-fecha_nacimiento,#signupform-celular,#signupform-identificacion").on("focusout",function(e){var i=$("#"+$(this).data("spanid"));setMessage("",""),i.html($(this).val()),_form.yiiActiveForm("validateAttribute","signupform-foto")}),$("#signupform-celular,#signupform-token,#signupform-password_fake,#signupform-password_repeat_fake,#obtener-token-button,#foto-button,#documentoidentificacion-button,#reset-button").on("focusout",function(e){setMessage("",""),_form.yiiActiveForm("validateAttribute","signupform-foto")}),$(".nombresaspirante,.correosaspirante,#signupform-fecha_nacimiento,#signupform-identificacion,#signupform-celular,#signupform-token,#signupform-password_fake,#signupform-password_repeat_fake,#obtener-token-button,#signupform-tipo_identificacion_select2,#foto-button,#documentoidentificacion-button,#reset-button").on("focusin",function(e){setMessage($(this).data("message"),"info")}),$(".nombresaspirante").on("keyup",function(e){var i=e.target.selectionStart;$(this).val($(this).val().toUpperCase()),setCaretPosition(this,i)}),$(".correosaspirante").on("keyup",function(e){var i=e.target.selectionStart;$(this).val($(this).val().toLowerCase()),setCaretPosition(this,i)}),$("#signupform-celular,#signupform-identificacion,#signupform-correo_electronico,#signupform-repite_correo_electronico").on("keyup",function(e){""!=$("#signupform-celular").val()&&""!=$("#signupform-identificacion").val()&&""!=$("#signupform-correo_electronico").val()&&validacion()}),$(':input[type="number"]').on("keypress",function(e){var i="keyCode"in(e=e||window.event)?e.keyCode:e.which;(187===i||43===i||101===i||44===i||45===i||46===i||39===i||222===i||$(this).val().length>=$(this).attr("maxlength"))&&e.preventDefault()}),$("#obtener-token-button").on("click",function(e){celular=$("#signupform-celular").val(),identificacion=$("#signupform-identificacion").val(),correo_electronico=$("#signupform-correo_electronico").val(),celular.match(/^[3]\d{9}$/g)?$.ajax({url:urlsms,type:"post",data:{"Token[celular]":celular,"Token[correo_electronico]":correo_electronico,"Token[identificacion]":identificacion},cache:!1,async:!0,success:function(e){tokenobtenido=e.resultado,setMessage(e.message,tokenobtenido?"success":"danger"),tokenobtenido&&listocelular()}}).done(function(){}).fail(function(){}).always(function(){}):$("#signupform-celular").blur()});